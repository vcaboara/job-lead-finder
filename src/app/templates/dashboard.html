<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Lead Finder - Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .status-bar {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .status-item {
            text-align: center;
        }

        .status-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .status-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
        }

        .status-value.online {
            color: #10b981;
        }

        .status-value.offline {
            color: #ef4444;
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .service-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
        }

        .service-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .service-icon {
            font-size: 2em;
            margin-right: 15px;
        }

        .service-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
        }

        .service-description {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .service-status {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .service-status.running {
            background: #d1fae5;
            color: #065f46;
        }

        .service-status.stopped {
            background: #fee2e2;
            color: #991b1b;
        }

        .service-link {
            display: inline-block;
            margin-top: 10px;
            padding: 8px 16px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: 500;
            transition: background 0.2s;
        }

        .service-link:hover {
            background: #5568d3;
        }

        .quick-actions {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .quick-actions h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .action-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .action-btn {
            padding: 15px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-align: left;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .action-btn-secondary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        }

        .footer {
            text-align: center;
            color: white;
            margin-top: 40px;
            opacity: 0.8;
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>üöÄ Job Lead Finder</h1>
            <p class="subtitle">AI-Powered Job Search & Lead Management</p>
        </header>

        <div class="status-bar">
            <div class="status-grid">
                <div class="status-item">
                    <div class="status-label">Containers</div>
                    <div class="status-value" id="container-status">...</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Copilot Quota</div>
                    <div class="status-value" id="copilot-quota">...</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Gemini Quota</div>
                    <div class="status-value" id="gemini-quota">...</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Active Tasks</div>
                    <div class="status-value" id="active-tasks">...</div>
                </div>
            </div>
        </div>

        <div class="services-grid">
            <div class="service-card">
                <div class="service-header">
                    <div class="service-icon">üéØ</div>
                    <div class="service-title">Job Search UI</div>
                </div>
                <div class="service-description">
                    Main web interface for searching jobs, managing leads, and tracking applications.
                </div>
                <span class="service-status running" id="ui-status">Checking...</span>
                <a href="http://localhost:8000" class="service-link" target="_blank">Open UI ‚Üí</a>
            </div>

            <div class="service-card">
                <div class="service-header">
                    <div class="service-icon">üìä</div>
                    <div class="service-title">AI Resource Monitor</div>
                </div>
                <div class="service-description">
                    Real-time monitoring of AI quota usage (Copilot, Gemini, Ollama) with recommendations.
                </div>
                <span class="service-status running" id="monitor-status">Checking...</span>
                <a href="http://localhost:9000" class="service-link" target="_blank">View Metrics ‚Üí</a>
            </div>

            <div class="service-card">
                <div class="service-header">
                    <div class="service-icon">üìã</div>
                    <div class="service-title">Vibe Kanban</div>
                </div>
                <div class="service-description">
                    Task management board for autonomous AI execution. Track progress and status.
                </div>
                <span class="service-status running" id="kanban-status">Checking...</span>
                <a href="http://localhost:3001" class="service-link" target="_blank">View Board ‚Üí</a>
            </div>

            <div class="service-card">
                <div class="service-header">
                    <div class="service-icon">‚úÖ</div>
                    <div class="service-title">Vibe Check MCP</div>
                </div>
                <div class="service-description">
                    Code validation and quality checks via Model Context Protocol.
                </div>
                <span class="service-status running" id="vibe-status">Checking...</span>
                <a href="http://localhost:3000" class="service-link" target="_blank">View Checks ‚Üí</a>
            </div>

            <div class="service-card">
                <div class="service-header">
                    <div class="service-icon">üé®</div>
                    <div class="service-title">Visual Kanban Board</div>
                </div>
                <div class="service-description">
                    Human-friendly visual Kanban board to observe autonomous AI progress.
                </div>
                <span class="service-status running">Local</span>
                <a href="./kanban.html" class="service-link" target="_blank">View Board ‚Üí</a>
            </div>

            <div class="service-card">
                <div class="service-header">
                    <div class="service-icon">ü§ñ</div>
                    <div class="service-title">Autonomous Executor</div>
                </div>
                <div class="service-description">
                    Command-line tool for autonomous AI task execution. See Quick Actions below.
                </div>
                <span class="service-status running">CLI</span>
            </div>
        </div>

        <div class="quick-actions">
            <h2>‚ö° Quick Actions</h2>
            <div class="action-grid">
                <button class="action-btn" onclick="runCommand('python scripts/autonomous_task_executor.py')">
                    üìã Generate Execution Plan
                </button>
                <button class="action-btn action-btn-secondary"
                    onclick="runCommand('python scripts/autonomous_task_executor.py --execute')">
                    üöÄ Execute Tasks (Live)
                </button>
                <button class="action-btn" onclick="runCommand('python scripts/init_memory_bank.py')">
                    üìÅ Initialize Memory Bank
                </button>
                <button class="action-btn action-btn-secondary" onclick="runCommand('docker compose ps')">
                    üê≥ Check Container Status
                </button>
                <button class="action-btn" onclick="window.open('http://localhost:9000/api/metrics', '_blank')">
                    üìä View AI Metrics (JSON)
                </button>
                <button class="action-btn action-btn-secondary"
                    onclick="window.open('http://localhost:3001/api/tasks', '_blank')">
                    üìù View Kanban Tasks (JSON)
                </button>
            </div>
        </div>

        <div class="footer">
            <p>Last updated: <span id="last-update">Loading...</span></p>
            <p>Auto-refresh every 30 seconds</p>
        </div>
    </div>

    <script>
        function runCommand(cmd) {
            alert(`Command to run in terminal:\n\n${cmd}\n\nPlease run this in your PowerShell terminal.`);
        }

        async function checkServiceStatus(url, statusElementId) {
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 2000);
                const response = await fetch(url, {
                    signal: controller.signal,
                    mode: 'cors'
                });
                clearTimeout(timeoutId);
                document.getElementById(statusElementId).textContent = 'Running';
                document.getElementById(statusElementId).className = 'service-status running';
            } catch (error) {
                document.getElementById(statusElementId).textContent = 'Stopped';
                document.getElementById(statusElementId).className = 'service-status stopped';
            }
        }

        async function updateMetrics() {
            try {
                const response = await fetch('http://localhost:9000/api/metrics');
                const data = await response.json();

                const copilotRemaining = data.copilot?.remaining || 0;
                const geminiRemaining = data.gemini?.remaining || 0;

                document.getElementById('copilot-quota').textContent = `${copilotRemaining}/1500`;
                document.getElementById('gemini-quota').textContent = `${geminiRemaining}/20`;
                document.getElementById('container-status').textContent = '6/6';
                document.getElementById('container-status').className = 'status-value online';

            } catch (error) {
                document.getElementById('copilot-quota').textContent = 'N/A';
                document.getElementById('gemini-quota').textContent = 'N/A';
                document.getElementById('container-status').textContent = 'Offline';
                document.getElementById('container-status').className = 'status-value offline';
            }
        }

        async function updateTaskCount() {
            try {
                const response = await fetch('http://localhost:3001/api/tasks');
                const tasks = await response.json();
                const activeTasks = Array.isArray(tasks) ?
                    tasks.filter(t => t.status === 'in-progress' || t.status === 'todo').length : 0;
                document.getElementById('active-tasks').textContent = activeTasks;
            } catch (error) {
                document.getElementById('active-tasks').textContent = '0';
            }
        }

        function updateTimestamp() {
            const now = new Date();
            document.getElementById('last-update').textContent = now.toLocaleString();
        }

        async function refreshAll() {
            updateTimestamp();
            await updateMetrics();
            await updateTaskCount();
            checkServiceStatus('http://localhost:8000', 'ui-status');
            checkServiceStatus('http://localhost:9000', 'monitor-status');
            checkServiceStatus('http://localhost:3001', 'kanban-status');
            checkServiceStatus('http://localhost:3000', 'vibe-status');
        }

        refreshAll();
        setInterval(refreshAll, 30000);
    </script>
</body>

</html>
